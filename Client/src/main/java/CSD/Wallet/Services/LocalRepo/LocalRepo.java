package CSD.Wallet.Services.LocalRepo;

import CSD.Wallet.Crypto.Utils.PaillierKey;

import java.math.BigInteger;
import java.util.HashMap;
import java.util.Map;

import static CSD.Wallet.Services.LocalRepo.KeyType.*;


public class LocalRepo {

    private static LocalRepo instance = null;

    private static String JWT;

    private static String RND_KEY = "GFYBbT5GAZa7ayccFFW2Ag==";
    private static String DET_KEY = "MRXYRB90M8cwt1CSqGEp8Q==";
    private static String OPE_KEY = "2053700769052212928";
    private static String RND_IV = "Z+7gfGlBVBK+YmiyrV6Wow==";
    private static String PL_p = "105403554787519221327854528807326078777458134074157617344283141776922257033449180273310937220184549572163359354557302741514020519692556655306784978337991422355168964047049529790226533334906455522957372053538161002057324489965636513797278441162842692639916706243109156708572718170105061654871556212346023008323";
    private static String PL_q = "170644682655370038537484135239663845422543744046912327021081695818614692843420032275834722319536931870073223833857079182609427759515764009633313015700632763647879665644958775456959094308748922545683939133843468138197765002297421523736746583839400093627560396785927763846456997635365425757834587174049911276919";
    private static String PL_lambda = "8993278078732063427731823157054364859536874538310902636833267821544767113477273779452998108967598365791025312394028645702720337365707477640465621578557320749980183480581291564574572107973433034240979545656709812914254649952900790654068741738040166566333445297804851239992323179683090130769240682493536243697531723419304873984093551112600113176955314675188565920871071882824190372739149663744605835286975722908819784288392588926959083020173897790805768196957548966550947293678023690287398159436599750226472851865311629656279914544379234839936212611644437227106963678609787630149218457939626494122221013416179380255798";
    private static String PL_n = "17986556157464126855463646314108729719073749076621805273666535643089534226954547558905996217935196731582050624788057291405440674731414955280931243157114641499960366961162583129149144215946866068481959091313419625828509299905801581308137483476080333132666890595609702479984646359366180261538481364987072487395339495076052637228052440889247216278110631228498201786107508603243917695355168540038357330113672927259876151765199559778041614319556116246551634387953722119104943217048055685821981946516854878521587014918004888452814918581021527717406450248291117240481404460248612180853466631684723475657148170218754694796837";
    private static String PL_nsquare = "323516202405610696148752807139368029428523865192074069017980478943205623285811338189718167866886147338512712492688580098082077517228627408100881988367852626432547714235948093531005374922317835501776744706635402864393042331446225992033177653220031632271133960786711435944967703023563374170790277259701592598580616379584409605964445476774684842904553674396248012954933503825181408292037189277254298189575685585578901726177037112832328863646035818080231145716848927727578183850919114129179947977645738845101095594555086662221145721044986297074452503511674303511987841690832449886103276034594482718605833894917405122249496379646553852732454190348320763243595685538000492908714226863299882828047719628119333178889775996290862730600854725906463401015331579391980145988982528368005521491576834329780446841771424167286157235025881814523412057794930998195435981789800794005299892697360775911148222019656672028805217969179064200445841149960856619687490283738794551874919449736097614325816809619797988904891173742137066435392718184151837791482148883459256440634255066800331130043804178184100640159909954785262994668446186238599951765660647750354600413667082992480506305911910983484503372428227994952697574901860694074303529172237304840705204569";
    private static String PL_g = "116899940949736960606933473427877906119877362149419460111652924043118442117458258074570855985026173051882612358740476960249423501160607364649377257583089252254567049619742318588979265270037231356484519462728939125788796103261999137395998552832580167541169026902548929708170349257208853152921468414069149336858368728507945813726925637369518511388310337203969383142921850025040538988309491899781969817643056757468391740372454340480435083954821914045547817212927183871871206920359361218333043717307583421641074120938007202909521224738100308674779395414634359689154795780551574822194497569645969587535101788782269948979246058628034463637053862111481897232604752493617774043330347286540397589743846257180076614721792680535384546213542233828588804726339089756587558465463445105881762070256434480102389710087304218967600646665097064615244676176730357653593423576325843554693837461602248402873730294413196594298401322072199227953977147466868030335880458832320962729842507305410904543450271785853362150310864134572920408725591752488339472066724034685859410588113416172085711187624875134305085896636538386879997970241970610893100926688632821831668909462302668761012138529770699038925145417998933628837106696116921383386773598357159964373157686";
    private static String PL_m = "6057912978296136442559664617728454361074047028743115446334098263057512025312555233268090377155840178923620022086723972027172533930862862518007798278586386434627640059185057414559112547347475977415050990950425169174017183050488878843520526299860295252098249371798894032474959792484058046707077188404858009561262454926038483890458419948134569150998562005980139423205398847748346245633954854900018443004126948314047603990762925522015453847348485944213135165237367720452943369669196057685619203196099688402784201721846465317237177574693771868830905230579519820683879882986429873122671530106241833527287835173998122374887";
    private static String SR_KEY = "aU8ybHV6PoXkgm+sOICfqw==";

    private static Map<String, String> onionKeys;
    private static PaillierKey pk;

    /*static{
        HomoOpeInt h = new HomoOpeInt(Long.valueOf(OPE_KEY));
        System.out.println("HomoOPE{0}= " + h.encrypt(0));
        System.out.println("HomoOPE{999999999}= " + h.encrypt(999999999));
    }*/

    private LocalRepo() {
        onionKeys = new HashMap<>();
        onionKeys.put(RND.name(), RND_KEY);
        onionKeys.put(DET.name(), DET_KEY);
        onionKeys.put(IV.name(), RND_IV);
        onionKeys.put(OPE.name(), OPE_KEY);
        onionKeys.put(SR.name(), SR_KEY);
        setPaillier();
    }

    private void setPaillier() {
        BigInteger p = new BigInteger(PL_p);
        BigInteger q = new BigInteger(PL_q);
        BigInteger lambda = new BigInteger(PL_lambda);
        BigInteger n = new BigInteger(PL_n);
        BigInteger nsquare = new BigInteger(PL_nsquare);
        BigInteger g = new BigInteger(PL_g);
        BigInteger mu = new BigInteger(PL_m);
        pk = new PaillierKey(p, q, lambda, n, nsquare, g, mu);
    }

    public PaillierKey getPk() {
        return pk;
    }


    public static LocalRepo getInstance() {
        if (instance == null)
            instance = new LocalRepo();
        return instance;
    }

    public void setJWT(String JWT) {
        LocalRepo.JWT = JWT;
    }

    public String getJWT() {
        return JWT;
    }

    public String getKey(KeyType keytype) {
        return onionKeys.get(keytype.name());
    }


}
